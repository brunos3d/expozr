# ğŸš€ Expozr

**Universal plugin ecosystem for dynamic module sharing**

Expozr enables any web bundler to expose and consume modules at runtime, creating a truly decentralized application architecture that's simpler and more flexible than traditional approaches.

> **ğŸš§ Current Status**: Expozr is in active development. The core functionality and Webpack adapter are working with examples available. See [examples](./examples) for working demos.

## ğŸ¯ Core Concepts

### ğŸª **Expozr** (Remote Application)

The application that **exposes** modules. Think of it as a supplier in the ecosystem.

- Contains the actual implementation of shared components/utilities
- Generates an **Inventory** (exposure map)
- Can be deployed independently

### ğŸ  **Host** (Consumer Application)

The application that **consumes** exposed modules from expozrs.

- Loads modules from Expozrs at runtime
- Uses a **Catalog** to discover available modules
- Handles dependency resolution automatically

### ğŸ“¦ **Cargo** (Exposed Module)

Individual module/component being shared.

- Can be a React component, utility function, entire library, etc.
- Has metadata: name, version, dependencies, entry point
- Loaded dynamically at runtime

### ğŸ“‹ **Inventory** (Exposure Map)

JSON manifest generated by Expozrs that lists all available Cargo with metadata.

### ğŸ§­ **Navigator** (Runtime Loader)

Universal runtime system that handles dynamic loading, dependency resolution, and caching.

## âœ¨ Key Features

### ğŸ™ **Universal Module System**

- ğŸŒ **Bundler Agnostic**: Works with any bundler (Webpack, Vite, Rollup, Rspack, etc.)
- âœ¨ **Multi-Format Support**: ESM, UMD, CJS, AMD, IIFE, SystemJS with automatic detection
- ğŸ§  **Intelligent Fallbacks**: Graceful degradation when preferred formats fail
- âš¡ **Hybrid Mode**: Load both ESM and UMD versions of the same module

### ğŸš€ **Runtime Excellence**

- ğŸš€ **Dynamic Loading**: Load modules at runtime without build-time coupling
- ğŸ¯ **Smart Format Detection**: Automatically detects and loads the best available format
- ğŸ› ï¸ **Error Recovery**: Comprehensive error handling with detailed feedback
- ğŸ“Š **Format Tracking**: Monitor which formats are successfully loaded

### ğŸ”§ **Developer Experience**

- ğŸ”§ **Great DX**: Simple APIs, CLI tools, and comprehensive documentation
- ğŸ—ï¸ **TypeScript First**: Full type safety with intelligent autocompletion
- ğŸ“± **Cross-Platform**: Works seamlessly in Browser and Node.js environments
- ğŸ”¥ **Hot Reloading**: Development-time module reloading support

### âš™ï¸ **Advanced Configuration**

- ğŸ”„ **Version Management**: Semantic versioning with automatic resolution
- ğŸ—ï¸ **Dependency Resolution**: Smart dependency handling and conflict resolution
- âš™ï¸ **Configuration Presets**: Pre-built configurations for common scenarios
- ğŸ› ï¸ **Plugin Architecture**: Extensible system for custom functionality

### ğŸ’¾ **Intelligent Caching**

- ğŸ’¾ **Multiple Strategies**: Memory, localStorage, IndexedDB, or no caching
- â±ï¸ **TTL Support**: Time-based cache invalidation
- ï¿½ **Cache Analytics**: Monitor cache performance and hit rates
- ğŸ”„ **Smart Invalidation**: Automatic cache updates when modules change

### ğŸ”’ **Production Ready**

- ğŸ›¡ï¸ **Error Boundaries**: Graceful error handling and recovery
- ğŸ“Š **Performance Monitoring**: Track loading times and cache efficiency
- ï¿½ **Debug Mode**: Detailed logging for development and troubleshooting
- ğŸš€ **Optimized Loading**: Preloading and lazy loading strategies

## ğŸš€ Quick Start

Here's a minimal example of setting up an Expozr remote application and a host application using Webpack and React. (see [examples](./examples) for full working examples)

**webpack.config.js:**

First, add the Expozr Webpack plugin to your Webpack configuration:

```javascript
const { createExpozrPlugin } = require("@expozr/webpack-adapter");

module.exports = {
  plugins: [createExpozrPlugin()],
};
```

**expozr.config.ts:**

Everything goes around a simple configuration file the `expozr.config.ts`:

```typescript
import { defineExpozrConfig } from "@expozr/core";

export default defineExpozrConfig({
  name: "my-components",
  version: "1.0.0",
  expose: {
    "./Button": {
      entry: "./src/components/Button.tsx",
      exports: ["Button", "ButtonProps"],
    },
  },
  dependencies: {
    react: "^18.0.0",
    "react-dom": "^18.0.0",
    // ...other shared dependencies
  },
  build: {
    outDir: "dist",
    publicPath: "http://localhost:3001/",
  },
});
```

**React Host app:**

Now you can load and use the exposed components in your React host application:

```typescript
import React from "react";
import { loadReactExpozr } from "@expozr/react";

const expozr = loadReactExpozr("http://localhost:3001");

// Load React components dynamically
const Button = React.lazy(() =>
  expozr.then((mod) => ({ default: mod.Button }))
);

// Use them in your React app
function App() {
  return (
    <div>
      <Button onClick={() => console.log("Clicked!")}>
        Click me!
      </Button>
    </div>
  );
}
```

## ğŸ“¦ Packages

### Core Packages

- **[@expozr/core](./packages/core)** - Core abstractions, types, and configuration system with multi-format module support (ESM, UMD, CJS)
- **[@expozr/navigator](./packages/navigator)** - Universal runtime loader with smart format detection, caching strategies, and cross-platform support

### Bundler Adapters

- **[@expozr/webpack-adapter](./packages/adapters/webpack)** - Webpack 5+ support with inventory generation and hot reloading
- **[@expozr/vite-adapter](./packages/adapters/vite)** - Vite support with ESM-first approach and development server integration
- **[@expozr/rollup-adapter](./packages/adapters/rollup)** - Rollup support _(coming soon)_
- **[@expozr/rspack-adapter](./packages/adapters/rspack)** - Rspack support _(coming soon)_

### Framework Utilities

- **[@expozr/react](./packages/react)** - React component loading utilities

### Developer Tools

- **[@expozr/cli](./packages/cli)** - Command line tools

## ğŸ› ï¸ Bundler Support

| Bundler    | Status     | Package                 |
| ---------- | ---------- | ----------------------- |
| Webpack 5+ | âœ… Ready   | @expozr/webpack-adapter |
| Vite       | âœ… Ready   | @expozr/vite-adapter    |
| Rollup     | ğŸ“‹ Planned | @expozr/rollup-adapter  |
| Rspack     | ğŸ“‹ Planned | @expozr/rspack-adapter  |
| Parcel     | ğŸ“‹ Planned | @expozr/parcel-adapter  |

### Advanced Configuration Examples

#### Multi-Format Module Support

```typescript
import { defineExpozrConfig, createHybridExpozrConfig } from "@expozr/core";

// Hybrid configuration supporting both ESM and UMD
export default createHybridExpozrConfig({
  name: "universal-components",
  entries: {
    "./Button": "./src/components/Button.tsx",
    "./Card": "./src/components/Card.tsx",
    "./utils": "./src/utils/index.ts",
  },
  build: {
    formats: ["esm", "umd"], // Build both formats
    globals: {
      react: "React",
      "react-dom": "ReactDOM",
    },
  },
});
```

#### Smart Caching Configuration

```typescript
import { createNavigator } from "@expozr/navigator";

const navigator = createNavigator({
  expozrs: {
    "ui-components": {
      url: "https://cdn.example.com/ui/",
      version: "^2.0.0",
    },
  },
  cache: {
    strategy: "indexedDB", // Persistent storage
    ttl: 86400000, // 24 hours
    maxSize: 100, // 100 modules max
  },
  loading: {
    timeout: 10000, // 10 seconds
    retries: 3, // Retry failed loads
    retryDelay: 1000, // 1 second between retries
  },
});

// Load with error handling
try {
  const cargo = await navigator.loadCargo("ui-components", "Button");
  console.log(`Loaded ${cargo.format} format using ${cargo.strategy} strategy`);
} catch (error) {
  console.error("Failed to load component:", error.message);
}
```

## ğŸ¨ Examples & Quick Start

The fastest way to understand Expozr is to run the examples! We have working examples for different bundlers and frameworks. Check out the [examples](./examples) directory for complete working examples and detailed setup instructions.

### ğŸ“‚ Examples Directory

**â¡ï¸ [View all examples](./examples/)**

| Example                                                      | Description             | Stack                   |
| ------------------------------------------------------------ | ----------------------- | ----------------------- |
| [**Webpack + Get Started**](./examples/webpack/get-started/) | Simplest possible setup | TypeScript              |
| [**Webpack + Vanilla**](./examples/webpack/vanilla/)         | Basic module sharing    | Vanilla JS + TypeScript |
| [**Webpack + React**](./examples/webpack/react/)             | React component sharing | React + TypeScript      |
| [**Webpack + ESM**](./examples/webpack/esm/)                 | Modern ES modules       | ESM + TypeScript        |
| [**Webpack + UMD**](./examples/webpack/umd/)                 | Universal module format | UMD + TypeScript        |
| [**Vite + React**](./examples/vite/react/)                   | Vite React components   | Vite + React + TS       |

### âš¡ Quick Start (2 minutes)

Try the simplest Get Started example:

```bash
# 1. Clone and setup
git clone https://github.com/brunos3d/expozr.git
cd expozr
npm install && npm run build

# 2. Start the expozr (port 3001)
cd examples/webpack/get-started/remote
npm install && npm run dev

# 3. In a new terminal, start the host (port 3000)
cd examples/webpack/get-started/host
npm install && npm run dev

# 4. Open http://localhost:3000 in your browser
```

**That's it!** You'll see the host loading and using utilities from the remote expozr in real-time.

### ğŸ¯ What You'll See

- âœ… **Automatic Config Discovery**: Zero configuration needed
- âœ… **Runtime Module Loading**: Modules loaded dynamically from remote
- âœ… **Hot Reloading**: Changes update instantly in development
- âœ… **Error Handling**: Clear error messages and troubleshooting

---

## ğŸ—ºï¸ Roadmap

### Phase 1: Foundation âœ…

- [x] Core library and types
- [x] Navigator runtime system
- [x] Webpack adapter
- [x] Vite adapter
- [x] React utilities
- [x] Working examples (Get Started, Vanilla, React, ESM, UMD, Vite)
- [x] Basic CLI tools (in beta)

### Phase 2: Expansion ğŸš§

- [ ] Stable CLI with templates
- [ ] Rollup adapter
- [ ] Advanced CLI features
- [ ] More framework examples (Vue, Angular, Svelte)
- [ ] Documentation website

### Phase 3: Production ğŸ“‹

- [ ] Performance optimizations
- [ ] Security features
- [ ] Monitoring tools
- [ ] Registry service
- [ ] VS Code extension

### Phase 4: Ecosystem ğŸ”®

- [ ] Plugin marketplace
- [ ] Community tools
- [ ] Enterprise features

## ğŸ¤ Contributing

We welcome contributions! Please see our [Contributing Guide](./CONTRIBUTING.md) for details.

## ğŸ“„ License

MIT Â© [Bruno Silva](https://github.com/brunos3d)

---

<div align="center">
  <strong>ğŸš€ Built with â¤ï¸ for the developer community</strong>
</div>
