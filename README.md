# üöÄ Expozr

**Universal plugin ecosystem for web bundler module federation**

Expozr enables any web bundler to expose and consume modules at runtime, creating a truly decentralized application architecture that's simpler and more flexible than traditional module federation solutions.

> **üöß Current Status**: Expozr is in active development. The core functionality and Webpack adapter are working with examples available. See [examples](./examples) for working demos.

## üéØ Core Concepts

### üè™ **Warehouse** (Remote Application)

The application that **exposes** modules. Think of it as a supplier in the ecosystem.

- Contains the actual implementation of shared components/utilities
- Generates an **Inventory** (exposure map)
- Can be deployed independently

### üè† **Host** (Consumer Application)

The application that **consumes** exposed modules from warehouses.

- Loads modules from Warehouses at runtime
- Uses a **Catalog** to discover available modules
- Handles dependency resolution automatically

### üì¶ **Cargo** (Exposed Module)

Individual module/component being shared.

- Can be a React component, utility function, entire library, etc.
- Has metadata: name, version, dependencies, entry point
- Loaded dynamically at runtime

### üìã **Inventory** (Exposure Map)

JSON manifest generated by Warehouses that lists all available Cargo with metadata.

### üß≠ **Navigator** (Runtime Loader)

Universal runtime system that handles dynamic loading, dependency resolution, and caching.

## ‚ú® Key Features

- üåç **Universal**: Works with any bundler (Webpack, Vite, Rollup, Rspack, etc.)
- üöÄ **Runtime Loading**: Dynamic module loading without build-time coupling
- üîÑ **Version Management**: Semantic versioning support with automatic resolution
- üèóÔ∏è **Dependency Resolution**: Smart dependency handling and conflict resolution
- üíæ **Intelligent Caching**: Multiple caching strategies (memory, localStorage, IndexedDB)
- üì± **Cross-Platform**: Works in both Browser and Node.js environments
- üîß **Great DX**: Simple APIs, CLI tools, and comprehensive documentation

## üöÄ Quick Start

### 1. Create a Warehouse (Expose Modules)

You can either use the CLI (in development) or set up manually:

**Option A: Manual Setup (Recommended)**

```bash
mkdir my-components && cd my-components
npm init -y
npm install @expozr/webpack-adapter webpack webpack-cli typescript ts-loader
```

**Option B: CLI (Beta)**

```bash
npx @expozr/cli init warehouse my-components
cd my-components
npm install
```

**expozr.config.ts:**

```typescript
import { defineWarehouseConfig } from "@expozr/core";

export default defineWarehouseConfig({
  name: "my-components",
  version: "1.0.0",
  expose: {
    "./Button": {
      entry: "./src/components/Button.tsx",
      exports: ["Button", "ButtonProps"],
    },
    "./Card": {
      entry: "./src/components/Card.tsx",
      exports: ["Card", "CardProps"],
    },
    "./utils": {
      entry: "./src/utils/index.ts",
      exports: ["add", "multiply"],
    },
  },
  build: {
    outDir: "dist",
    publicPath: "http://localhost:3001/",
  },
});
```

**webpack.config.js:**

```javascript
const { createWarehousePlugin } = require("@expozr/webpack-adapter");

module.exports = {
  plugins: [createWarehousePlugin()],
};
```

### 2. Create a Host (Consume Modules)

```bash
npx @expozr/cli init host my-app
cd my-app
npm install
```

**For React components, install React support:**

```bash
npm install @expozr/react react react-dom
```

**expozr.config.ts (Host):**

```typescript
import { defineWarehouseConfig } from "@expozr/core";

export default defineWarehouseConfig({
  name: "my-host",
  version: "1.0.0",
  expose: {
    // Currently just a consumer, but ready to expose modules if needed
  },
  metadata: {
    description: "Host application that consumes remote components",
    author: "Your Name",
    license: "MIT",
  },
});
```

**app.tsx:**

```typescript
import React from "react";
import { loadReactWarehouse } from "@expozr/react";

const warehouse = loadReactWarehouse("http://localhost:3001");

// Load React components dynamically
const Button = React.lazy(() =>
  warehouse.then((mod) => ({ default: mod.Button }))
);

// Use them in your React app
function App() {
  return (
    <div>
      <Button onClick={() => console.log("Clicked!")}>
        Click me!
      </Button>
    </div>
  );
}
```

## üì¶ Installation

```bash
# Core packages
npm install @expozr/core @expozr/navigator @expozr/webpack-adapter

# React support
npm install @expozr/react

# CLI tools (beta)
npm install -g @expozr/cli
```

## üì¶ Packages

### Core Packages

- **[@expozr/core](./packages/core)** - Core abstractions and types
- **[@expozr/navigator](./packages/navigator)** - Runtime loader for Browser & Node.js

### Bundler Adapters

- **[@expozr/webpack-adapter](./packages/adapters/webpack)** - Webpack 5+ support
- **[@expozr/vite-adapter](./packages/adapters/vite)** - Vite support _(coming soon)_
- **[@expozr/rollup-adapter](./packages/adapters/rollup)** - Rollup support _(coming soon)_
- **[@expozr/rspack-adapter](./packages/adapters/rspack)** - Rspack support _(coming soon)_

### Framework Utilities

- **[@expozr/react](./packages/react)** - React component loading utilities

### Developer Tools

- **[@expozr/cli](./packages/cli)** - Command line tools

## üõ†Ô∏è Bundler Support

| Bundler    | Status     | Package                 |
| ---------- | ---------- | ----------------------- |
| Webpack 5+ | ‚úÖ Ready   | @expozr/webpack-adapter |
| Vite       | üìã Planned | @expozr/vite-adapter    |
| Rollup     | üìã Planned | @expozr/rollup-adapter  |
| Rspack     | üìã Planned | @expozr/rspack-adapter  |
| Parcel     | üìã Planned | @expozr/parcel-adapter  |

## üîß Configuration

### Warehouse Configuration

```typescript
export default defineWarehouseConfig({
  name: "my-warehouse",
  version: "1.0.0",
  expose: {
    "./Button": {
      entry: "./src/Button.tsx",
      exports: ["Button", "ButtonProps"],
      dependencies: {
        react: "^18.0.0",
      },
    },
  },
  metadata: {
    description: "My component library",
    author: "Your Name",
  },
});
```

### Host Configuration

```typescript
export default defineWarehouseConfig({
  name: "my-host",
  version: "1.0.0",
  expose: {
    // Hosts can also expose modules if needed
  },
  metadata: {
    description: "Host application consuming remote components",
    author: "Your Name",
  },
});
```

## üé® Examples & Quick Start

The fastest way to understand Expozr is to run the examples! We have working examples for different bundlers and frameworks.

### üìÇ Examples Directory

**‚û°Ô∏è [View all examples](./examples/)**

| Example                                              | Description             | Stack                   | Demo                      |
| ---------------------------------------------------- | ----------------------- | ----------------------- | ------------------------- |
| [**Webpack + Vanilla**](./examples/webpack/vanilla/) | Basic module federation | Vanilla JS + TypeScript | [‚ñ∂Ô∏è Try it](#quick-start) |
| [**Webpack + React**](./examples/webpack/react/)     | React component sharing | React + TypeScript      | [‚ñ∂Ô∏è Try it](#quick-start) |

### ‚ö° Quick Start (2 minutes)

Try the Vanilla JavaScript example:

```bash
# 1. Clone and setup
git clone https://github.com/brunos3d/expozr.git
cd expozr
npm install && npm run build

# 2. Start the warehouse (port 3001)
cd examples/webpack/vanilla/remote
npm install && npm run dev

# 3. In a new terminal, start the host (port 3000)
cd examples/webpack/vanilla/host
npm install && npm run dev

# 4. Open http://localhost:3000 in your browser
```

**That's it!** You'll see the host loading and using utilities from the remote warehouse in real-time.

### üéØ What You'll See

- ‚úÖ **Automatic Config Discovery**: Zero configuration needed
- ‚úÖ **Runtime Module Loading**: Modules loaded dynamically from remote
- ‚úÖ **Hot Reloading**: Changes update instantly in development
- ‚úÖ **Error Handling**: Clear error messages and troubleshooting

### üöÄ Try React Components

For React component federation:

```bash
# Start React warehouse
cd examples/webpack/react/remote && npm install && npm run dev

# Start React host (new terminal)
cd examples/webpack/react/host && npm install && npm run dev
```

See React components loaded dynamically between applications!

## üìö Framework Support

### ‚öõÔ∏è React

Expozr provides first-class React support with `@expozr/react`:

```typescript
import { loadReactWarehouse, setupReactGlobals } from "@expozr/react";

// Setup React globals (call once at app start)
setupReactGlobals();

// Load React warehouse
const warehouse = loadReactWarehouse("http://localhost:3001");

// Use with React.lazy for automatic code splitting
const Button = React.lazy(() =>
  warehouse.then((mod) => ({ default: mod.Button }))
);

// Or load directly
const { Button, Card } = await warehouse;
```

**Features:**

- ‚úÖ **React.lazy Integration**: Seamless lazy loading with Suspense
- ‚úÖ **Hot Reloading**: Works with React dev server
- ‚úÖ **Hook Sharing**: Share custom React hooks between apps
- ‚úÖ **Automatic Globals**: Sets up React/ReactDOM globals for UMD modules

---

Check out the [examples](./examples) directory for complete working examples and detailed setup instructions.

## üåü Why Expozr?

- **Simpler**: No complex configuration or dependency management
- **Flexible**: Runtime discovery and loading
- **Lightweight**: No framework lock-in or routing complexity
- **Granular**: Share individual components, not entire applications
- **Efficient**: Smart caching and dependency resolution

### vs Package Registries

- **Dynamic**: Load modules at runtime, not build time
- **Versioned**: Multiple versions can coexist
- **Distributed**: No central registry required

## üó∫Ô∏è Roadmap

### Phase 1: Foundation ‚úÖ

- [x] Core library and types
- [x] Navigator runtime system
- [x] Webpack adapter
- [x] React utilities
- [x] Working examples (Vanilla JS + React)
- [x] Basic CLI tools (in beta)

### Phase 2: Expansion üöß

- [ ] Stable CLI with templates
- [ ] Vite adapter
- [ ] Rollup adapter
- [ ] Advanced CLI features
- [ ] More framework examples
- [ ] Documentation website

### Phase 3: Production üìã

- [ ] Performance optimizations
- [ ] Security features
- [ ] Monitoring tools
- [ ] Registry service
- [ ] VS Code extension

### Phase 4: Ecosystem üîÆ

- [ ] Plugin marketplace
- [ ] Community tools
- [ ] Enterprise features

## ü§ù Contributing

We welcome contributions! Please see our [Contributing Guide](./CONTRIBUTING.md) for details.

## üìÑ License

MIT ¬© [Bruno Silva](https://github.com/brunos3d)

---

<div align="center">
  <strong>üöÄ Built with ‚ù§Ô∏è for the developer community</strong>
</div>
